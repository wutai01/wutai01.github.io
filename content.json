[{"title":"观察者模式理解与使用","date":"2017-01-16T09:51:00.000Z","path":"2017/01/16/观察者模式理解与使用/","text":"观察者模式优点： 1.时间上的解耦： 发布-订阅模式可以广泛应用于异步编程中，这是一种替代传递回调函数的方案。比如，我们可以订阅 ajax 请求的 error、succ等事件。或者如果想在动画的每一帧完成之后做一些事情，那我们可以订阅一个事件，然后在动画的每一帧完成之后发布这个事件。在异步编程中使用发布—订阅模式，我们就无需过多关注对象在异步运行期间的内部状态，而只需要订阅感兴趣的事件发生点。 2.对象上的解耦： 发布—订阅模式可以取代对象之间硬编码的通知机制，一个对象不用再显式地调用另外一个对象的某个接口。发布—订阅模式让两个对象松耦合地联系在一起，虽然不太清楚彼此的细节，但这不影响它们之间相互通信。当有新的订阅者出现时，发布者的代码不需要任何修改；同样发布者需要改变时，也不会影响到之前的订阅者。只要之前约定的事件名没有变化，就可以自由地改变它们。 var event = { clientList: [], listen: function( key, fn ){ if ( !this.clientList[ key ] ){ this.clientList[ key ] = []; } this.clientList[ key ].push( fn ); // 订阅的消息添加进缓存列表 }, trigger: function(){ var key = Array.prototype.shift.call( arguments ), // (1); fns = this.clientList[ key ]; if ( !fns || fns.length === 0 ){ // 如果没有绑定对应的消息 return false; } for( var i = 0, fn; fn = fns[ i++ ]; ){ fn.apply( this, arguments ); // (2) // arguments 是 trigger 时带上的参数 } }, remove: function( key, fn ){ var fns = this.clientList[ key ]; if ( !fns ){ // 如果 key 对应的消息没有被人订阅，则直接返回 return false; } if ( !fn ){ // 如果没有传入具体的回调函数，表示需要取消 key 对应消息的所有订阅 fns &amp;&amp; ( fns.length = 0 ); }else{ for ( var l = fns.length - 1; l &gt;=0; l– ){ // 反向遍历订阅的回调函数列表 var _fn = fns[ l ]; if ( _fn === fn ){ fns.splice( l, 1 ); // 删除订阅者的回调函数 } } } } }; var salesOffices = {}; var installEvent = function( obj ){ for ( var i in event ){ obj[ i ] = event[ i ]; } }; installEvent( salesOffices ); salesOffices.listen( ‘squareMeter88’, fn1 = function( price ){ // 小明订阅消息 console.log( ‘价格= ‘ + price ); }); salesOffices.listen( ‘squareMeter88’, fn2 = function( price ){ // 小红订阅消息 console.log( ‘价格= ‘ + price ); }); salesOffices.remove( ‘squareMeter88’, fn1 ); // 删除小明的订阅 salesOffices.trigger( ‘squareMeter88’, 2000000 ); // 输出：2000000 使用场景：参考：《设计模式与开发实践》","tags":[{"name":"js设计模式","slug":"js设计模式","permalink":"http://yoursite.com/tags/js设计模式/"}]},{"title":"helloWorld","date":"2017-01-16T09:50:39.000Z","path":"2017/01/16/helloWorld/","text":"基于hexo+github搭建的博客，挺好用的。","tags":[{"name":"生活","slug":"生活","permalink":"http://yoursite.com/tags/生活/"}]}]